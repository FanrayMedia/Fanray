variables:
  buildConfiguration: 'Release'

jobs:
- job: Linux
  pool:
    vmImage: 'ubuntu-latest'  
 
  steps:
  - task: UseDotNet@2
    displayName: ".NET Core 3.1.x"
    inputs:
      version: '3.1.x'
      packageType: sdk
  - script: dotnet build --configuration $(buildConfiguration)
      displayName: 'dotnet build $(buildConfiguration)'

  - task: DotNetCoreCLI@2
      displayName: "Test"
      inputs:
        command: test
        projects: '**/*tests/*.csproj'
        arguments: '--configuration $(buildConfiguration)'

- job: macOS
  pool:
    vmImage: 'macOS-latest'

  steps:
  - task: UseDotNet@2
    displayName: ".NET Core 3.1.x"
    inputs:
      version: '3.1.x'
      packageType: sdk
  - script: dotnet build --configuration $(buildConfiguration)
      displayName: 'dotnet build $(buildConfiguration)'

  - task: DotNetCoreCLI@2
      displayName: "Test"
      inputs:
        command: test
        projects: '**/*tests/*.csproj'
        arguments: '--configuration $(buildConfiguration)'

- job: Windows
  pool:
    vmImage: 'windows-latest'
  
  steps:
  - task: UseDotNet@2
    displayName: ".NET Core 3.1.x"
    inputs:
      version: '3.1.x'
      packageType: sdk
  - script: dotnet build --configuration $(buildConfiguration)
      displayName: 'dotnet build $(buildConfiguration)'

  - task: DotNetCoreCLI@2
      displayName: "Test"
      inputs:
        command: test
        projects: '**/*tests/*.csproj'
        arguments: '--configuration $(buildConfiguration)'
