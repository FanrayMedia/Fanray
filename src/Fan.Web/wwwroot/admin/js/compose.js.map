{"version":3,"sources":["../../../Areas/Admin/js/compose.js"],"names":["Delta","Quill","import","Clipboard","PlainClipboard","onPaste","e","preventDefault","range","quill","getSelection","text","clipboardData","getData","delta","retain","index","delete","length","insert","updateContents","setSelection","scrollIntoView","clearTimeout","typingTimer","app","published","showSave","disableSave","saveText","setTimeout","saveDraft","doneTypingInterval","register","Vue","el","data","id","pubClicked","pubText","closing","fieldChanged","drawer","menuDate","date","selectedCatId","cats","selectedTags","tags","slug","excerpt","title","toolbarOptions","mediaDialogVisible","images","change","computed","showMediaDialog","get","getImages","set","value","disablePubButton","trim","tok","document","querySelector","payload","content","root","innerHTML","postDate","categoryId","body","mounted","initHighlight","initEditor","methods","modules","syntax","toolbar","imageResize","theme","location","href","substring","window","lastIndexOf","axios","then","resp","post","clipboard","dangerouslyPasteHTML","allCats","allTags","on","compose","onbeforeunload","getModule","addHandler","hljs","configure","languages","onFieldsChange","headers","endsWith","history","replaceState","catch","revert","pub","url","replace","uploadImages","input","createElement","setAttribute","click","onchange","formData","FormData","i","files","append","$root","insertImage","insertEmbed"],"mappings":"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","file":"compose.js","sourcesContent":["ï»¿/**\r\n * @see Compose.cshtml\r\n */\r\nlet Delta = Quill.import('delta');\r\nconst Clipboard = Quill.import('modules/clipboard');\r\nclass PlainClipboard extends Clipboard {\r\n    onPaste(e) {\r\n        e.preventDefault()\r\n        const range = this.quill.getSelection()\r\n        const text = e.clipboardData.getData('text/plain')\r\n        const delta = new Delta()\r\n            .retain(range.index)\r\n            .delete(range.length)\r\n            .insert(text)\r\n        const index = text.length + range.index\r\n        const length = 0\r\n        this.quill.updateContents(delta, 'silent')\r\n        this.quill.setSelection(index, length, 'silent')\r\n        this.quill.scrollIntoView()\r\n\r\n        clearTimeout(this.typingTimer);\r\n        if (!app.published) {\r\n            app.showSave = true;\r\n            app.disableSave = false;\r\n            app.saveText = 'Save';\r\n\r\n            this.typingTimer = setTimeout(app.saveDraft, app.doneTypingInterval);\r\n        }\r\n    }\r\n}\r\nQuill.register('modules/clipboard', PlainClipboard, true);\r\n\r\nvar app = new Vue({\r\n    el: '#app',\r\n    data: () => ({\r\n        id: 0,\r\n        published: false,\r\n        pubClicked: false,\r\n        pubText: '',\r\n        showSave: false,\r\n        disableSave: false,\r\n        saveText: 'Save',\r\n        closing: true,\r\n        fieldChanged: false,\r\n        drawer: null,\r\n        menuDate: false,\r\n        date: '',\r\n        selectedCatId: 1,\r\n        cats: [],\r\n        selectedTags: [],\r\n        tags: [],\r\n        slug: '',\r\n        excerpt: '',\r\n        title: '',\r\n        quill: null,\r\n        toolbarOptions: [\r\n            [{ 'header': [false, 1, 2, 3, 4, 5, 6,] }],\r\n            ['bold', 'italic', 'underline', 'strike'],\r\n            [{ 'list': 'ordered' }, { 'list': 'bullet' }, { 'list': 'check' }],\r\n            ['blockquote', 'code-block'],\r\n            ['link', 'image', 'video'],\r\n            [{ 'align': '' }, { 'align': 'center' }, { 'align': 'right' }, { 'align': 'justify' }],\r\n            [{ 'indent': '-1' }, { 'indent': '+1' }],\r\n            [{ 'color': [] }, { 'background': [] }],\r\n            ['clean'],\r\n        ],\r\n        mediaDialogVisible: false,\r\n        images: [],\r\n        change: null,\r\n        doneTypingInterval: 5000,\r\n    }),\r\n    computed: {\r\n        showMediaDialog: {\r\n            get: function () {\r\n                if (this.mediaDialogVisible) {\r\n                    this.getImages();\r\n                }\r\n                return this.mediaDialogVisible\r\n            },\r\n            set: function (value) {\r\n                if (!value) {\r\n                    this.mediaDialogVisible = false;\r\n                }\r\n            }\r\n        },\r\n        disablePubButton() {\r\n            return this.title.trim().length <= 0 || this.pubClicked;\r\n        },\r\n        tok: function () {\r\n            return document.querySelector('input[name=\"__RequestVerificationToken\"][type=\"hidden\"]').value;\r\n        },\r\n        payload: function () {\r\n            let content = this.quill.root.innerHTML;\r\n            if (content === '<p><br></p>') content = '';\r\n\r\n            return {\r\n                id: this.id,\r\n                postDate: this.date,\r\n                categoryId: this.selectedCatId,\r\n                tags: this.selectedTags,\r\n                slug: this.slug,\r\n                excerpt: this.excerpt,\r\n                title: this.title,\r\n                body: content,\r\n            }\r\n        },\r\n    },\r\n    mounted() {\r\n        this.initHighlight();\r\n        this.initEditor();\r\n    },\r\n    methods: {\r\n        initEditor() {\r\n            this.quill = new Quill('#editor', {\r\n                modules: {\r\n                    syntax: true,\r\n                    toolbar: this.toolbarOptions,\r\n                    imageResize: {},\r\n                },\r\n                theme: 'snow'\r\n            });\r\n\r\n            this.id = window.location.href.substring(window.location.href.lastIndexOf(\"/\") + 1) | 0;\r\n            axios.get(`/admin/compose?handler=post&postId=${this.id}`).then(resp => {\r\n                this.date = resp.data.post.postDate;\r\n                this.selectedCatId = resp.data.post.categoryId;\r\n                this.selectedTags = resp.data.post.tags;\r\n                this.slug = resp.data.post.slug;\r\n                this.excerpt = resp.data.post.excerpt;\r\n                this.title = resp.data.post.title;\r\n                this.quill.clipboard.dangerouslyPasteHTML(resp.data.post.body);\r\n                this.published = resp.data.published;\r\n                this.cats = resp.data.allCats;\r\n                this.tags = resp.data.allTags;\r\n                this.pubText = this.published ? 'Update' : 'Publish';\r\n                this.change = new Delta();\r\n\r\n                // auto save\r\n                let typingTimer;\r\n                this.quill.on('text-change', (delta) => {\r\n                    this.change = this.change.compose(delta);\r\n                    clearTimeout(typingTimer);\r\n                    if (this.change.length() > 0 && !this.published) {\r\n                        this.showSave = true;\r\n                        this.disableSave = false;\r\n                        this.saveText = 'Save';\r\n\r\n                        typingTimer = setTimeout(this.saveDraft, this.doneTypingInterval);\r\n                    }\r\n                });\r\n                window.onbeforeunload = () => {\r\n                    if ((this.change.length() > 0 || this.fieldChanged) && this.closing) {\r\n                        return 'There are unsaved changes. Are you sure you want to leave?';\r\n                    }\r\n                }\r\n            });\r\n\r\n            // media\r\n            let toolbar = this.quill.getModule('toolbar');\r\n            toolbar.addHandler('image', () => this.mediaDialogVisible = true);\r\n        },\r\n        initHighlight() {\r\n            hljs.configure({\r\n                languages: ['cs', 'css', 'java', 'javascript', 'markdown', 'ruby', 'python', 'scss', 'sql', 'typescript', 'xml']\r\n            });\r\n        },\r\n        onFieldsChange() {\r\n            this.fieldChanged = true;\r\n            if (this.published) return;\r\n            this.showSave = true;\r\n            this.disableSave = false;\r\n            this.saveText = 'Save';\r\n        },\r\n        saveDraft() {\r\n            this.showSave = true;\r\n            this.disableSave = true;\r\n            this.saveText = 'Saving...';\r\n\r\n            axios.post('/admin/compose?handler=save', this.payload, { headers: { 'XSRF-TOKEN': this.tok } })\r\n                .then(resp => {\r\n                    this.id = resp.data.id;\r\n                    this.slug = resp.data.slug;\r\n                    if (window.location.href.endsWith('/compose'))\r\n                        history.replaceState({}, null, window.location.href + `/${this.id}`);\r\n                })\r\n                .catch(err => { console.log(err); });\r\n\r\n            this.change = new Delta();\r\n            this.fieldChanged = false;\r\n            this.saveText = 'Saved';\r\n        },\r\n        revert() {\r\n            this.published = false;\r\n            this.pubText = this.published ? 'Update' : 'Publish';\r\n            this.saveDraft();\r\n        },\r\n        pub() {\r\n            this.closing = false;\r\n            this.pubClicked = true;\r\n            this.pubText = this.published ? 'Updating...' : 'Publishing...';\r\n\r\n            const url = this.published ? '/admin/compose?handler=update' : '/admin/compose?handler=publish';\r\n            axios.post(url, this.payload, { headers: { 'XSRF-TOKEN': this.tok } })\r\n                .then(resp => {\r\n                    window.location.replace(resp.data);\r\n                })\r\n                .catch(err => { console.log(err); });\r\n        },\r\n        uploadImages() {\r\n            const input = document.createElement('input');\r\n            input.setAttribute('type', 'file');\r\n            input.setAttribute('accept', 'image/*');\r\n            input.setAttribute('multiple', null);\r\n            input.click();\r\n            input.onchange = () => {\r\n                const formData = new FormData();\r\n                for (let i = 0; i < input.files.length; i++) {\r\n                    formData.append('images', input.files[i]);\r\n                }\r\n\r\n                axios.post('/admin/media?handler=image', formData, { headers: { 'XSRF-TOKEN': this.$root.tok } })\r\n                    .then(resp => {\r\n                        this.images = resp.data.images;\r\n                    })\r\n                    .catch(err => {\r\n                        console.log(err);\r\n                    });\r\n            };\r\n        },\r\n        getImages() {\r\n            let url = `/admin/media?handler=images`;\r\n            axios.get(url).then(resp => {\r\n                this.images = resp.data.images;\r\n            }).catch(err => console.log(err));\r\n        },\r\n        insertImage(url) {\r\n            const range = this.quill.getSelection();\r\n            this.quill.insertEmbed(range.index, 'image', url);\r\n            this.mediaDialogVisible = false;\r\n        },\r\n    },\r\n});\r\n"]}